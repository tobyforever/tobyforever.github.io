<!DOCTYPE html><html lang="zh"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no,minimal-ui"><meta name="renderer" content="webkit"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black"><meta name="format-detection" content="telephone=no,email=no,adress=no"><meta name="theme-color" content="#000000"><meta http-equiv="window-target" content="_top"><title>主流时间库横向对比 | Hexo</title><meta name="description" content="背景根据《State of Frontend 2022》问卷调查， 最受欢迎的前五个工具库中，时间处理相关的库占据了两席。时间处理工具为什么如此受前端工程师青睐？JS Date 为什么无法满足开发需求？不同的时间库之间又存在哪些差异？ 时间计量标准时间包含了时刻和时段两个概念，常规意义上的时段是可以通过两个时刻计算得到的，但地球自转的不稳定，这种方式得到的时段并不是恒定的，因而诞生了两种时间计量系"><meta property="og:type" content="article"><meta property="og:title" content="主流时间库横向对比"><meta property="og:url" content="https://www.linmingzhe.com/blog/2023/04/11/frontend/date-lib/index.html"><meta property="og:site_name" content="z的个人博客"><meta property="og:description" content="背景根据《State of Frontend 2022》问卷调查， 最受欢迎的前五个工具库中，时间处理相关的库占据了两席。时间处理工具为什么如此受前端工程师青睐？JS Date 为什么无法满足开发需求？不同的时间库之间又存在哪些差异？ 时间计量标准时间包含了时刻和时段两个概念，常规意义上的时段是可以通过两个时刻计算得到的，但地球自转的不稳定，这种方式得到的时段并不是恒定的，因而诞生了两种时间计量系"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/tobyforever/uploadpic/upload/20230412115334.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/tobyforever/uploadpic/upload/20230412115634.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/tobyforever/uploadpic/upload/20230412120110.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/tobyforever/uploadpic/upload/20230412120122.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/tobyforever/uploadpic/upload/20230412120135.png"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/tobyforever/uploadpic/upload/20230412120155.png"><meta property="article:published_time" content="2023-04-11T13:45:51.000Z"><meta property="article:modified_time" content="2023-06-06T05:14:54.656Z"><meta property="article:author" content="z"><meta property="article:tag" content="js"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/tobyforever/uploadpic/upload/20230412115334.png"><link rel="canonical" href="https://www.linmingzhe.com/blog/2023/04/11/frontend/date-lib/index.html"><link rel="alternate" href="/atom.xml" title="z的个人博客" type="application/atom+xml"><link rel="icon" href="/favicon.png" type="image/x-icon"><link rel="stylesheet" href="/css/style.css"><meta name="generator" content="Hexo 6.3.0"></head><body class="main-center theme-blue" itemscope itemtype="http://schema.org/WebPage"><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="slimContent"><div class="navbar-header"><div class="profile-block text-center"><a id="avatar" href="https://www.linmingzhe.com" target="_blank"><img class="img-circle img-rotate" src="/images/avatar.jpg" width="200" height="200"></a><h2 id="name" class="hidden-xs hidden-sm">z</h2><h3 id="title" class="hidden-xs hidden-sm hidden-md">keep walking, keep thinking</h3><small id="location" class="text-muted hidden-xs hidden-sm"><i class="icon icon-map-marker"></i> China</small></div><div class="search" id="search-form-wrap"><form class="search-form sidebar-form"><div class="input-group"><input type="text" class="search-form-input form-control" placeholder="搜索"> <span class="input-group-btn"><button type="submit" class="search-form-submit btn btn-flat" onclick="return!1"><i class="icon icon-search"></i></button></span></div></form><div class="ins-search"><div class="ins-search-mask"></div><div class="ins-search-container"><div class="ins-input-wrapper"><input type="text" class="ins-search-input" placeholder="想要查找什么..." x-webkit-speech> <button type="button" class="close ins-close ins-selectable" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">×</span></button></div><div class="ins-section-wrapper"><div class="ins-section-container"></div></div></div></div></div><button class="navbar-toggle collapsed" type="button" data-toggle="collapse" data-target="#main-navbar" aria-controls="main-navbar" aria-expanded="false"><span class="sr-only">Toggle navigation</span> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span></button></div><nav id="main-navbar" class="collapse navbar-collapse" itemscope itemtype="http://schema.org/SiteNavigationElement" role="navigation"><ul class="nav navbar-nav main-nav"><li class="menu-item menu-item-home"><a href="/."><i class="icon icon-home-fill"></i> <span class="menu-title">首页</span></a></li><li class="menu-item menu-item-archives"><a href="/archives"><i class="icon icon-archives-fill"></i> <span class="menu-title">归档</span></a></li><li class="menu-item menu-item-categories"><a href="/categories"><i class="icon icon-folder"></i> <span class="menu-title">分类</span></a></li><li class="menu-item menu-item-tags"><a href="/tags"><i class="icon icon-tags"></i> <span class="menu-title">标签</span></a></li><li class="menu-item menu-item-repository"><a href="/repository"><i class="icon icon-project"></i> <span class="menu-title">项目</span></a></li><li class="menu-item menu-item-books"><a href="/books"><i class="icon icon-book-fill"></i> <span class="menu-title">书单</span></a></li><li class="menu-item menu-item-links"><a href="/links"><i class="icon icon-friendship"></i> <span class="menu-title">友链</span></a></li><li class="menu-item menu-item-about"><a href="/about"><i class="icon icon-cup-fill"></i> <span class="menu-title">关于</span></a></li></ul><ul class="social-links"><li><a href="/atom.xml" target="_blank" title="Rss" data-toggle="tooltip" data-placement="top"><i class="icon icon-rss"></i></a></li></ul></nav></div></header><aside class="sidebar" itemscope itemtype="http://schema.org/WPSideBar"><div class="slimContent"><div class="widget"><h3 class="widget-title">公告</h3><div class="widget-body"><div id="board"><div class="content"><p>欢迎交流与分享经验!</p></div></div></div></div><div class="widget"><h3 class="widget-title">标签</h3><div class="widget-body"><ul class="tag-list" itemprop="keywords"><li class="tag-list-item"><a class="tag-list-link" href="/tags/bigdata/" rel="tag">bigdata</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gis/" rel="tag">gis</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/" rel="tag">java</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/js/" rel="tag">js</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/liberal-education/" rel="tag">liberal-education</a><span class="tag-list-count">1</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/" rel="tag">linux</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/network/" rel="tag">network</a><span class="tag-list-count">3</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" rel="tag">大数据</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%99%E8%82%B2/" rel="tag">教育</a><span class="tag-list-count">6</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E5%AD%A6/" rel="tag">数学</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" rel="tag">数据库</a><span class="tag-list-count">2</span></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/%E6%BC%94%E8%AE%B2/" rel="tag">演讲</a><span class="tag-list-count">1</span></li></ul></div></div><div class="widget"><h3 class="widget-title">标签云</h3><div class="widget-body tagcloud"><a href="/tags/bigdata/" style="font-size:13px">bigdata</a> <a href="/tags/gis/" style="font-size:13px">gis</a> <a href="/tags/java/" style="font-size:13px">java</a> <a href="/tags/js/" style="font-size:13px">js</a> <a href="/tags/liberal-education/" style="font-size:13px">liberal-education</a> <a href="/tags/linux/" style="font-size:13.67px">linux</a> <a href="/tags/network/" style="font-size:13.67px">network</a> <a href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/" style="font-size:14px">大数据</a> <a href="/tags/%E6%95%99%E8%82%B2/" style="font-size:14px">教育</a> <a href="/tags/%E6%95%B0%E5%AD%A6/" style="font-size:13.33px">数学</a> <a href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" style="font-size:13.33px">数据库</a> <a href="/tags/%E6%BC%94%E8%AE%B2/" style="font-size:13px">演讲</a></div></div><div class="widget"><h3 class="widget-title">最新文章</h3><div class="widget-body"><ul class="recent-post-list list-unstyled no-thumbnail"><li><div class="item-inner"><p class="item-category"></p><p class="item-title"><a href="/blog/2023/07/22/education/new-concept-math/" class="title">新概念数学</a></p><p class="item-date"><time datetime="2023-07-22T15:46:51.000Z" itemprop="datePublished">2023-07-22</time></p></div></li><li><div class="item-inner"><p class="item-category"></p><p class="item-title"><a href="/blog/2023/07/20/education/typing-test/" class="title">打字练习</a></p><p class="item-date"><time datetime="2023-07-20T15:46:51.000Z" itemprop="datePublished">2023-07-20</time></p></div></li><li><div class="item-inner"><p class="item-category"></p><p class="item-title"><a href="/blog/2023/06/10/education/brain-workout-collection/" class="title">探究式问题收藏</a></p><p class="item-date"><time datetime="2023-06-10T15:46:51.000Z" itemprop="datePublished">2023-06-10</time></p></div></li><li><div class="item-inner"><p class="item-category"></p><p class="item-title"><a href="/blog/2023/06/06/math/how-to-excel-in-math-ai/" class="title">AI说如何学数学</a></p><p class="item-date"><time datetime="2023-06-06T15:46:51.000Z" itemprop="datePublished">2023-06-06</time></p></div></li><li><div class="item-inner"><p class="item-category"></p><p class="item-title"><a href="/blog/2023/06/05/education/oscar-study-diary/" class="title">带娃日记</a></p><p class="item-date"><time datetime="2023-06-05T15:46:51.000Z" itemprop="datePublished">2023-06-05</time></p></div></li></ul></div></div></div></aside><main class="main" role="main"><div class="content"><article id="post-frontend/date-lib" class="article article-type-post" itemscope itemtype="http://schema.org/BlogPosting"><div class="article-header"><h1 class="article-title" itemprop="name">主流时间库横向对比</h1><div class="article-meta"><span class="article-date"><i class="icon icon-calendar-check"></i> <a href="/blog/2023/04/11/frontend/date-lib/" class="article-date"><time datetime="2023-04-11T13:45:51.000Z" itemprop="datePublished">2023-04-11</time> </a></span><span class="article-tag"><i class="icon icon-tags"></i> <a class="article-tag-link-link" href="/tags/js/" rel="tag">js</a> </span><span class="article-read hidden-xs"><i class="icon icon-eye-fill" aria-hidden="true"></i> <span id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span> </span></span><span class="post-comment"><i class="icon icon-comment"></i> <a href="/blog/2023/04/11/frontend/date-lib/#comments" class="article-comment-link">评论</a></span></div></div><div class="article-entry marked-body" itemprop="articleBody"><h1 id="背景"><a href="#背景" class="headerlink" title="背景"></a>背景</h1><p>根据《State of Frontend 2022》问卷调查， 最受欢迎的前五个工具库中，时间处理相关的库占据了两席。时间处理工具为什么如此受前端工程师青睐？JS Date 为什么无法满足开发需求？不同的时间库之间又存在哪些差异？<br><img src="https://cdn.jsdelivr.net/gh/tobyforever/uploadpic/upload/20230412115334.png"></p><h1 id="时间"><a href="#时间" class="headerlink" title="时间"></a>时间</h1><h2 id="计量标准"><a href="#计量标准" class="headerlink" title="计量标准"></a>计量标准</h2><p>时间包含了时刻和时段两个概念，常规意义上的时段是可以通过两个时刻计算得到的，但地球自转的不稳定，这种方式得到的时段并不是恒定的，因而诞生了两种时间计量系统：<br>世界时（GMT）：根据地球自转的天文测量得到，并不稳定。<br>原子时（IAT）：根据原子的单次振动时间得到，可以认为是恒定不变的。<br>这两种时间尺度速率上的不同每一至二年会带来会差大约1秒的差异，因此每隔一定时间会在原子时的基础上增加或减少1秒，即闰秒，得到接近于世界时的时间，称为协调世界时（UTC）。</p><h2 id="时区"><a href="#时区" class="headerlink" title="时区"></a>时区</h2><p>全球被划分为24个时区。规定英国的格林威治天文台旧址所在经线为基准线，即本初子午线，所在时区为零时区，零时区以东为东 1-12 区，以西为西 1-12 区（东12区和西12区是重合的）。每差一个时区，区时相差一小时，越往东区时越早。为了让世界各地都有一个统一的参照时间，规定零时区的 UTC 时间作为标准时间，简称 UTC 时间。<br><img src="https://cdn.jsdelivr.net/gh/tobyforever/uploadpic/upload/20230412115634.png"></p><h1 id="new-Date"><a href="#new-Date" class="headerlink" title="new Date()"></a>new Date()</h1><h2 id="YYYY-MM-DD-的时区问题"><a href="#YYYY-MM-DD-的时区问题" class="headerlink" title="YYYY-MM-DD 的时区问题"></a>YYYY-MM-DD 的时区问题</h2><p>使用 new Date(‘yyyy-MM-dd’) 实例化 Date 对象时，由于没有指定具体时刻，系统会自动设置一个时刻为 ‘00:00:00’ 的 UTC 时间，并在用户访问时，返回系统时区的对应时间。如，位于东八区的开发者访问 Date 显示的时间是 UTC+8。位于西七区的开发者访问 Date 显示的时间是 UTC-7。也就是说，如果直接使用 new Date(‘yyyy-MM-dd’) 设置时间，位于不同时区的用户会获取不同的结果，某些情况下会导致意想不到的bug。<br>使用 new Date(‘yyyy-MM-dd HH:mm:ss’) 或其他官方推荐的日期格式实例化对象，如new Date(dd, MM yyyy)，可以避免上述时区问题，创建当前时区下 00:00:00 的 Date 对象。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 时区为中国</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Date</span>(<span class="string">&#x27;2022-10-24&#x27;</span>) </span><br><span class="line"><span class="comment">// print: Mon Oct 24 2022 08:00:00 GMT+0800 (中国标准时间)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 时区为美国</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Date</span>(<span class="string">&#x27;2022-10-24&#x27;</span>) </span><br><span class="line"><span class="comment">// print: Sun Oct 23 2022 17:00:00 GMT-0700 (北美太平洋夏令时间)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 new Date(&#x27;YYYY-MM-DD HH-MM-SS&#x27;) 可以创建当前时区的 Date 对象</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Date</span>(<span class="string">&#x27;2022-10-24 00:00:00&#x27;</span>)</span><br><span class="line"><span class="comment">// print: Mon Oct 24 2022 00:00:00 GMT+0800 (中国标准时间)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 传入格式为&#x27;DD, MM YYYY&#x27;的日期</span></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Date</span>(<span class="string">&#x27;10, 24 2022&#x27;</span>)</span><br><span class="line"><span class="comment">// print: Mon Oct 24 2022 00:00:00 GMT+0800 (中国标准时间)</span></span><br></pre></td></tr></table></figure><h2 id="Safari-的兼容性问题"><a href="#Safari-的兼容性问题" class="headerlink" title="Safari 的兼容性问题"></a>Safari 的兼容性问题</h2><p>Safari 只支持 yyyy&#x2F;MM&#x2F;dd 或 MM&#x2F;dd&#x2F;yyyy 或 MMMM DD, YYYY 格式的日期，使用 new Date(‘YYYY-MM-DD’) 会报错。</p><h2 id="无法解析或展示特定格式的日期"><a href="#无法解析或展示特定格式的日期" class="headerlink" title="无法解析或展示特定格式的日期"></a>无法解析或展示特定格式的日期</h2><p>特定格式日期的解析需要借助正则表达式来完成。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 通过正则表达式解析</span></span><br><span class="line"><span class="keyword">const</span> datePattern = <span class="regexp">/^(\d&#123;2&#125;)-(\d&#123;2&#125;)-(\d&#123;4&#125;)$/</span>;</span><br><span class="line"><span class="keyword">const</span> [, month, day, year] = datePattern.<span class="title function_">exec</span>(<span class="string">&#x27;10-24-2022&#x27;</span>);</span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Date</span>(<span class="string">`<span class="subst">$&#123;month&#125;</span>, <span class="subst">$&#123;day&#125;</span> <span class="subst">$&#123;year&#125;</span>`</span>);</span><br></pre></td></tr></table></figure><h1 id="主流时间库"><a href="#主流时间库" class="headerlink" title="主流时间库"></a>主流时间库</h1><h2 id="MomentJS"><a href="#MomentJS" class="headerlink" title="MomentJS"></a>MomentJS</h2><p>彻底解决解析问题和格式化问题</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> date1 = <span class="title function_">moment</span>(<span class="string">&#x27;2022-10-24&#x27;</span>);</span><br><span class="line">date1.<span class="title function_">format</span>()   <span class="comment">// print: 2022-10-24T00:00:00+08:00</span></span><br><span class="line">date1.<span class="title function_">toArray</span>()  <span class="comment">// print: [2022, 9, 24, 0, 0, 0, 0]，注：月份的起始数为0</span></span><br><span class="line">date1.<span class="title function_">toJSON</span>()   <span class="comment">// print: 2022-10-23T16:00:00.000Z</span></span><br></pre></td></tr></table></figure><p>适配多种甚至自定义的格式写法</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> date2 = <span class="title function_">moment</span>(<span class="string">&#x27;10/24/2022&#x27;</span>, <span class="string">&#x27;MM/DD/YYYY&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> date3 = <span class="title function_">moment</span>(<span class="string">&#x27;2022-10-24-4-30&#x27;</span>, <span class="string">&#x27;YYYY-MM-DD-HH-mm&#x27;</span>);</span><br></pre></td></tr></table></figure><p>包体积大：MomentJS 包体积过于庞大，接近 300kb，且基于 OOP（Object Oriented Programming）的设计需要先引入 moment 对象，再使用对象中的方法，导致无法通过 tree-shaking 压缩体积，引用后会打包所有方法，容易引发首屏加载的性能问题。<br>时间对象是可变的（mutable）：对时间对象的计算操作会改变对象本身，通常需要拷贝后操作。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  <span class="keyword">const</span> startDate = <span class="title function_">moment</span>(); </span><br><span class="line">  <span class="comment">// print: Sun Oct 23 2022 23:11:34 GMT+0800   const endDate = startDate.add(1, &#x27;year&#x27;); </span></span><br><span class="line">  <span class="comment">// print: Mon Oct 23 2023 23:11:34 GMT+0800</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(startDate === endDate);   </span><br><span class="line">  <span class="comment">// print: true</span></span><br></pre></td></tr></table></figure><p>目前 moment.js 由于历史包袱的原因升级困难， 加上更好的替代品出现，已经停止维护。对于深度使用 moment.js 但希望更换时间库的项目，可以安装 eslint-plugin-you-dont-need-momentjs 来帮助升级。配置方式如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">// package.json</span><br><span class="line">&quot;extends&quot; : [&quot;plugin:you-dont-need-momentjs/recommended&quot;]</span><br></pre></td></tr></table></figure><h2 id="DayJS"><a href="#DayJS" class="headerlink" title="DayJS"></a>DayJS</h2><p>是 Moment.js 的轻量化方案，拥有同样强大的 API，但包体积只有 6.5KB。<br>不可变（Immutable）<br>体积小。为了减小体积，day.js 将一些复杂功能抽离到插件中，使用时需额外引入<br>拥有和 MomentJS 相同的 API，迁移成本低。但迁移时需注意：<br>注1：涉及到更改时间对象的操作，不能简单地替换。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">import moment from &quot;moment&quot;;</span><br><span class="line">const timeEntity = moment();</span><br><span class="line">timeEntity.add(1, &quot;d&quot;); // 天数加1</span><br><span class="line"></span><br><span class="line">import dayjs from &quot;dayjs&quot;;</span><br><span class="line">const timeEntity = moment();</span><br><span class="line">timeEntity = timeEntity.add(1, &quot;d&quot;); // 天数加1</span><br></pre></td></tr></table></figure><p>如果项目中大量依赖此类逻辑的话，Day.js 插件提供了适配方案，虽然官方并不推荐。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">var badMutable = require(&#x27;dayjs/plugin/badMutable&#x27;)</span><br><span class="line">dayjs.extend(badMutable) // with BadMutable plugin  const today = dayjs()</span><br><span class="line">today.add(1, &#x27;day&#x27;) // immutable</span><br></pre></td></tr></table></figure><p>注2：一些特殊功能需要通过插件额外引入，并进行配置。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">import dayjs from &quot;dayjs&quot;;</span><br><span class="line">import dayOfYear from &quot;dayjs/plugin/dayOfYear&quot;;</span><br><span class="line">import objectSupport from &quot;dayjs/plugin/objectSupport&quot;;</span><br><span class="line"></span><br><span class="line">// 配置插件</span><br><span class="line">dayjs.extend(dayOfYear);</span><br><span class="line">dayjs.extend(objectSupport);</span><br><span class="line"></span><br><span class="line">export default dayjs;</span><br><span class="line">utc 时间问题。 utc 插件的.utc()、.utcOffset()、.tz(&#x27;GMT&#x27;/&#x27;UTC&#x27;) 方法会返回 utc 时间对象，但 utc 模式下的格式化显示还存在较多问题，某些情况下会显示本地时间而非UTC时间，因此不建议使用 day.js 的 utc 插件。</span><br><span class="line">dayjs.extend(utc)</span><br><span class="line">dayjs(&#x27;2022-10-24&#x27;).utcOffset(0, true).format();</span><br><span class="line">// 2022-10-24T00:00:00Z</span><br><span class="line">dayjs(&#x27;2022-10-24&#x27;).utcOffset(0, true).add(0).format(); </span><br><span class="line">// result: 2022-10-23T16:00:00Z</span><br><span class="line">// expect: 2022-10-24T00:00:00Z</span><br><span class="line"></span><br><span class="line">dayjs.extend(utc)</span><br><span class="line">dayjs.extend(timezone)</span><br><span class="line">dayjs.tz(0, &#x27;UTC&#x27;).format()</span><br><span class="line">// 1970-01-01T00:00:00Z</span><br><span class="line">dayjs.tz(0, &#x27;UTC&#x27;).add(0,&#x27;minutes&#x27;).format()</span><br><span class="line">// result: 1969-12-31T16:00:00Z</span><br><span class="line">// expect: 1970-01-01T00:00:00Z</span><br></pre></td></tr></table></figure><h2 id="Date-fns"><a href="#Date-fns" class="headerlink" title="Date-fns"></a>Date-fns</h2><p>Date-fns 的 API 是基于 FP（Functional Programming）的，可以按需导入函数。<br>不可变（Immutable）<br>函数导入，但相比对象导入，调用不够灵活，每个工具函数都要从指定路径引入。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export addDays from &#x27;date-fns/addDays/index.js&#x27;</span><br><span class="line">const newDate = addDays(new Date(), 7);</span><br></pre></td></tr></table></figure><p>优化：将需要用到的工具函数引入到模块文件中，再对外暴露方法。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">// custom-date-fns.js</span><br><span class="line">export &#123; default as add &#125; from &#x27;date-fns/add/index.js&#x27;</span><br><span class="line">export &#123; default as addBusinessDays &#125; from &#x27;date-fns/addBusinessDays/index.js&#x27;</span><br><span class="line">export &#123; default as addDays &#125; from &#x27;date-fns/addDays/index.js&#x27;</span><br><span class="line">export &#123; default as addHours &#125; from &#x27;date-fns/addHours/index.js&#x27;</span><br></pre></td></tr></table></figure><p>add 操作，2KB<br><img src="https://cdn.jsdelivr.net/gh/tobyforever/uploadpic/upload/20230412120110.png"><br>format + add 操作，24.1KB<br><img src="https://cdn.jsdelivr.net/gh/tobyforever/uploadpic/upload/20230412120122.png"><br>parse 解析日期字符串，98.5KB<br><img src="https://cdn.jsdelivr.net/gh/tobyforever/uploadpic/upload/20230412120135.png"></p><h2 id="横向对比"><a href="#横向对比" class="headerlink" title="横向对比"></a>横向对比</h2><p><img src="https://cdn.jsdelivr.net/gh/tobyforever/uploadpic/upload/20230412120155.png"></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>Native Date 无法直接解析自定义格式的时间字符串，且容易引入时区问题。不推荐。<br>Moment.js 包体积过大，且时间对象存在 mutable 问题，源代码也早已停止维护。不推荐。<br>Day.js 克服了 moment.js 的缺陷，且 api 与 moment.js 高度吻合，从 moment.js 迁移成本低。但是部分功能需要通过插件引入，其中 utc 插件会引发 utc 时间的显示问题。建议在不涉及 UTC 时间的情况下使用。<br>Date-fns 同样克服了 moment.js 的缺陷，并支持 tree-shaking，单独使用某些功能时，引入的包体积甚至小于 day.js。但需要从目标目录导入所需的工具函数，上手难度大。在引入了多种工具函数或涉及解析时间字符串时，还会导致包体积过大。推荐轻度需求或 day.js 无法胜任时使用。</p></div><div class="article-footer"><blockquote class="mt-2x"><ul class="post-copyright list-unstyled"><li class="post-copyright-link hidden-xs"><strong>本文链接：</strong> <a href="https://www.linmingzhe.com/blog/2023/04/11/frontend/date-lib/" title="主流时间库横向对比" target="_blank" rel="external">https://www.linmingzhe.com/blog/2023/04/11/frontend/date-lib/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="http://creativecommons.org/licenses/by/4.0/deed.zh" target="_blank" rel="external">CC BY 4.0 CN协议</a> 许可协议。转载请注明出处！</li></ul></blockquote><div class="panel panel-default panel-badger"><div class="panel-body"><figure class="media"><div class="media-left"><a href="https://www.linmingzhe.com" target="_blank" class="img-burn thumb-sm visible-lg"><img src="/images/avatar.jpg" class="img-rounded w-full" alt=""></a></div><div class="media-body"><h3 class="media-heading"><a href="https://www.linmingzhe.com" target="_blank"><span class="text-dark">z</span><small class="ml-1x">keep walking, keep thinking</small></a></h3><div>不积跬步无以至千里</div></div></figure></div></div></div></article><section id="comments"><div id="vcomments"></div></section></div><nav class="bar bar-footer clearfix" data-stick-bottom><div class="bar-inner"><ul class="pager pull-left"><li class="prev"><a href="/blog/2023/04/12/devops/network-privatecloud/" title="私有云网络应用模型"><i class="icon icon-angle-left" aria-hidden="true"></i><span>&nbsp;&nbsp;上一篇</span></a></li><li class="next"><a href="/blog/2023/04/11/devops/docker-autoheal/" title="centos挂载数据盘"><span>下一篇&nbsp;&nbsp;</span><i class="icon icon-angle-right" aria-hidden="true"></i></a></li></ul><div class="bar-right"><div class="share-component" data-sites="wechat" data-mobile-sites="wechat"></div></div></div></nav></main><footer class="footer" itemscope itemtype="http://schema.org/WPFooter"><ul class="social-links"><li><a href="/atom.xml" target="_blank" title="Rss" data-toggle="tooltip" data-placement="top"><i class="icon icon-rss"></i></a></li></ul><div class="copyright"><div class="publishby">Theme by <a href="https://github.com/cofess" target="_blank">cofess </a>base on <a href="https://github.com/cofess/hexo-theme-pure" target="_blank">pure</a>.</div></div></footer><script src="//cdn.jsdelivr.net/npm/jquery@1.12.4/dist/jquery.min.js"></script><script>window.jQuery||document.write('<script src="js/jquery.min.js"><\/script>')</script><script src="/js/plugin.min.js"></script><script src="/js/application.js"></script><script>window.INSIGHT_CONFIG={TRANSLATION:{POSTS:"文章",PAGES:"页面",CATEGORIES:"分类",TAGS:"标签",UNTITLED:"(未命名)"},ROOT_URL:"/",CONTENT_URL:"/content.json"}</script><script src="/js/insight.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//cdn.jsdelivr.net/npm/valine"></script><script type="text/javascript">var GUEST=["nick","mail","link"],meta=(meta="nick,mail,link").split(",").filter(function(e){return-1<GUEST.indexOf(e)});new Valine({el:"#vcomments",verify:!1,notify:!1,appId:"",appKey:"",placeholder:"Just go go",avatar:"mm",meta:meta,pageSize:"10",visitor:!1})</script></body></html>